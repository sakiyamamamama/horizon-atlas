{"pageProps":{"metadata":{"title":"データベース基礎","curriculumId":"19d2297f-7a72-80e3-9222-fee4cd48536f","category":"後期","visibility":["基礎班","発展班"],"tags":["基礎班","データベース","Python"],"is_basic_curriculum":true,"id":"79"},"mdBlocks":[{"type":"paragraph","blockId":"19d2297f-7a72-8132-8c4f-db436e40f85f","parent":"今回はpythonとそのライブラリであるsqlite3を使用して、データベースのデータを取得する方法を紹介します。","children":[]},{"blockId":"19d2297f-7a72-81b1-a92a-d43e92e9a61a","type":"heading_2","parent":"## データの取得方法","children":[]},{"blockId":"19d2297f-7a72-81a2-bdae-e4efee9d2027","type":"divider","parent":"---","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-8140-b6e3-f2372ee0b9f2","parent":"データを取得する方法を見ていきましょう。","children":[]},{"blockId":"19d2297f-7a72-81af-badb-d2b43a76e6e8","type":"callout","parent":"> データを取得するSQL文  \n> ```sql  \n> SELECT カラム名 FROM テーブル名  \n> ```","children":[{"blockId":"19d2297f-7a72-8109-bc40-c955b6478568","type":"code","parent":"```sql\nSELECT カラム名 FROM テーブル名\n```","children":[]}]},{"type":"paragraph","blockId":"19d2297f-7a72-81bb-9c32-df0dbf3a14ed","parent":"これで指定したテーブルの中のカラムを取得できます。","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-8110-846f-d005002bea6a","parent":"テーブル内のすべてのデータを取得したい場合はカラム名に`*`を指定します。","children":[]},{"blockId":"19d2297f-7a72-812f-b555-df07b92f2132","type":"callout","parent":"> テーブル内のすべてのデータを取得する  \n> ```sql  \n> SELECT * FROM テーブル名  \n> ```","children":[{"blockId":"19d2297f-7a72-81ac-87d0-ea8ab0c9e04d","type":"code","parent":"```sql\nSELECT * FROM テーブル名\n```","children":[]}]},{"type":"paragraph","blockId":"19d2297f-7a72-81e3-b42a-fc71e7379cf4","parent":"取得するデータの条件を指定するには、`WHERE` 句をつけます。","children":[]},{"blockId":"19d2297f-7a72-816f-bf6a-f1de925503b4","type":"callout","parent":"> 取り出すデータに条件を指定する  \n> ```sql  \n> SELECT カラム名 FROM テーブル名 WHERE 条件  \n> ```","children":[{"blockId":"19d2297f-7a72-819e-bdb7-c64f081294df","type":"code","parent":"```sql\nSELECT カラム名 FROM テーブル名 WHERE 条件\n```","children":[]}]},{"type":"paragraph","blockId":"19d2297f-7a72-8158-8a9e-c38c03df3455","parent":"条件をつけることでどの行のデータを取得するかを指定できます。","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-818b-b789-ca201c9f12dc","parent":"条件には、「idが何か」を指定することが多いです。","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-8168-8a51-cc2f6a99885d","parent":"例えば、`id`の値が`1`の行のデータを取り出したい場合は以下のように書きます。","children":[]},{"blockId":"19d2297f-7a72-81d7-b836-c2dd559b6975","type":"callout","parent":"> id=1のデータのみを取得する  \n> ```sql  \n> SELECT * FROM テーブル名 WHERE id = 1  \n> ```","children":[{"blockId":"19d2297f-7a72-81e9-adb9-c24e90849cd5","type":"code","parent":"```sql\nSELECT * FROM テーブル名 WHERE id = 1\n```","children":[]}]},{"type":"paragraph","blockId":"19d2297f-7a72-81a9-b349-fdc7c80c7054","parent":"条件を複数指定する時は、`AND` を使います。","children":[]},{"blockId":"19d2297f-7a72-8199-bc6a-edf9aa7a1317","type":"callout","parent":"> 複数の条件を指定する  \n> ```sql  \n> SELECT カラム名 FROM テーブル名 WHERE 条件1 AND 条件2 AND ...  \n> ```","children":[{"blockId":"19d2297f-7a72-8190-95f3-ebedab7e03e3","type":"code","parent":"```sql\nSELECT カラム名 FROM テーブル名 WHERE 条件1 AND 条件2 AND ...\n```","children":[]}]},{"blockId":"19d2297f-7a72-81d7-a03b-eed6699a6ddc","type":"heading_2","parent":"## 実際にデータを取得してみよう","children":[]},{"blockId":"19d2297f-7a72-81e0-9900-dfc43230048c","type":"divider","parent":"---","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-8154-9c94-cc061548d163","parent":"「[**データの保存(Create)**](/posts/curriculums/19d2297f-7a72-80e3-9222-fee4cd48536f/19d2297f-7a72-819d-8ecc-ded1c97afcc0)」で保存したデータを取得してみよう。","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-819f-ad23-fb47275528a8","parent":"新たにread.pyを作成してください。","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-81c5-b3c0-da70442d8613","parent":"read.pyの内容を以下のようにしてください。","children":[]},{"blockId":"19d2297f-7a72-8181-914f-e51bf9545b97","type":"callout","parent":"> read.py  \n> ```python  \n> import sqlite3  \n>   \n> dbname = 'TEST.db'  \n> conn = sqlite3.connect(dbname)  \n> cur = conn.cursor()  \n>   \n> **# personテーブルデータを全件取得  \n> cur.execute('SELECT * FROM person')  \n> data = cur.fetchall()  \n> print(data)**  \n>   \n> conn.commit()  \n>   \n> cur.close()  \n> conn.close()  \n> ```","children":[{"blockId":"19d2297f-7a72-81c4-9f45-d4f6756ac340","type":"code","parent":"```python\nimport sqlite3\n\ndbname = 'TEST.db'\nconn = sqlite3.connect(dbname)\ncur = conn.cursor()\n\n**# personテーブルデータを全件取得\ncur.execute('SELECT * FROM person')\ndata = cur.fetchall()\nprint(data)**\n\nconn.commit()\n\ncur.close()\nconn.close()\n```","children":[]}]},{"type":"paragraph","blockId":"19d2297f-7a72-813a-8c55-f5e7c0502257","parent":"このコードを実行してください。\n以下のように出力されればデータの取得に成功です。","children":[]},{"blockId":"19d2297f-7a72-8139-875f-e365044c2869","type":"code","parent":"```bash\n[(1, 'Sato', 15, 'Man')]\n```","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-81b4-8810-eb6974be4179","parent":"コードを見ていきましょう。","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-81b6-93cd-de68168044ec","parent":"まず、`cur.execute(’SELECT * FROM person’)` で、`person`テーブルのデータをすべて取得するSQL文を実行します。次に、`fetchall`メソッドで取得したデータを全て変数`data`に代入し、`print`で出力しています。","children":[]},{"blockId":"19d2297f-7a72-81db-be80-ef189dd6d9ec","type":"heading_2","parent":"## 任意のデータを扱う","children":[]},{"blockId":"19d2297f-7a72-8198-901c-f4735b629090","type":"divider","parent":"---","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-819a-9009-e7df3e158fd4","parent":"データの取得をより実用的に扱うには、データを取得するとき、任意の値で条件を指定する必要があります。","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-8169-b2f9-db05ea232268","parent":"任意の値で条件を指定する方法を見ていきましょう。","children":[]},{"blockId":"19d2297f-7a72-8172-a445-dcf560eba8c6","type":"callout","parent":"> 例：idが任意の値の条件を指定する  \n> ```python  \n> cur.execute('SELECT カラム名 FROM テーブル名 WHERE id = ?',(指定したいidの値))  \n> ```  \n>   \n> 🛑 `cur` = `cursor`オブジェクト","children":[{"blockId":"19d2297f-7a72-8131-81ae-e55e244ccc8f","type":"code","parent":"```python\ncur.execute('SELECT カラム名 FROM テーブル名 WHERE id = ?',(指定したいidの値))\n```","children":[]},{"blockId":"19d2297f-7a72-8195-8427-f8cbe9faf0a5","type":"paragraph","parent":"🛑 `cur` = `cursor`オブジェクト","children":[]}]},{"type":"paragraph","blockId":"19d2297f-7a72-81c0-a283-fc3e636361a5","parent":"例えば、personテーブルから、任意のidの行のデータを取得するコードは以下のようになります。","children":[]},{"blockId":"19d2297f-7a72-81a9-8de0-d2188e5a2acd","type":"callout","parent":"> personテーブルから、任意のidの行のデータを取得する  \n> ```python  \n> import sqlite3  \n>   \n> dbname = 'TEST.db'  \n> conn = sqlite3.connect(dbname)  \n> cur = conn.cursor()  \n>   \n> **# 任意の値を入れる  \n> target_id = 1  \n>   \n> # personテーブルから任意の行のデータを取得  \n> cur.execute('SELECT * FROM person WHERE id = ?',(target_id,))  \n> data = cur.fetchall()**  \n>   \n> # 取得したデータを出力  \n> print(data)  \n>   \n> conn.commit()  \n>   \n> cur.close()  \n> conn.close()  \n> ```","children":[{"blockId":"19d2297f-7a72-810f-8f54-f50bf2efb48d","type":"code","parent":"```python\nimport sqlite3\n\ndbname = 'TEST.db'\nconn = sqlite3.connect(dbname)\ncur = conn.cursor()\n\n**# 任意の値を入れる\ntarget_id = 1\n\n# personテーブルから任意の行のデータを取得\ncur.execute('SELECT * FROM person WHERE id = ?',(target_id,))\ndata = cur.fetchall()**\n\n# 取得したデータを出力\nprint(data)\n\nconn.commit()\n\ncur.close()\nconn.close()\n```","children":[]}]},{"type":"paragraph","blockId":"19d2297f-7a72-815e-83b2-d72db9c3f071","parent":"このコードだと、`target_id`の値によって、テーブルから取得するデータの行が変わります。","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-8124-8e1c-d437ef5fe615","parent":"","children":[]},{"type":"paragraph","blockId":"19d2297f-7a72-81e2-b8ae-da720cbca459","parent":"次→[**データの編集(Update)**](/posts/curriculums/19d2297f-7a72-80e3-9222-fee4cd48536f/19d2297f-7a72-8165-b201-cd77e1e2d2f2)","children":[]}],"pageNavs":[{"title":"Home","id":"/posts"},{"title":"基礎班カリキュラム","id":"/posts/course/basic"},{"title":"後期","id":"/posts/course/後期"},{"title":"データベース基礎","id":"/posts/curriculums/19d2297f-7a72-80e3-9222-fee4cd48536f/19d2297f-7a72-81ae-ab43-f15cda8b9b88"}]},"__N_SSG":true}