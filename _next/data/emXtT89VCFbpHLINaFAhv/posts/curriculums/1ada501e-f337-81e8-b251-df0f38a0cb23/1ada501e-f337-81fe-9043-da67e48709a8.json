{"pageProps":{"metadata":{"title":"データベース基礎","curriculumId":"1ada501e-f337-81e8-b251-df0f38a0cb23","category":"後期","visibility":["基礎班","発展班"],"tags":["基礎班","データベース","Python"],"is_basic_curriculum":true,"id":"127"},"mdBlocks":[{"blockId":"1ada501e-f337-812b-ae0f-cf3000cc70ed","type":"paragraph","parent":"今回はpythonとそのライブラリであるsqlite3を使用して、データベースのデータを取得する方法を紹介します。","children":[]},{"blockId":"1ada501e-f337-81b2-905c-e5681cf686a0","type":"heading_2","parent":"## データの取得方法","children":[]},{"blockId":"1ada501e-f337-8135-83c2-f2c634b7ea82","type":"divider","parent":"---","children":[]},{"blockId":"1ada501e-f337-8119-86ef-fc9d55db7b68","type":"paragraph","parent":"データを取得する方法を見ていきましょう。","children":[]},{"blockId":"1ada501e-f337-81c1-a1b1-ccbb405495c1","type":"callout","parent":"{\"icon\":{\"type\":\"external\",\"external\":{\"url\":\"https://www.notion.so/icons/code_gray.svg\"}},\"color\":\"default_background\",\"parent\":\"> データを取得するSQL文  \\n> ```sql  \\n> SELECT カラム名 FROM テーブル名  \\n> ```\"}","children":[{"blockId":"1ada501e-f337-81d1-9742-f32e1ebd88d3","type":"code","parent":"```sql\nSELECT カラム名 FROM テーブル名\n```","children":[]}]},{"blockId":"1ada501e-f337-81f2-93fe-dccf37bdec3f","type":"paragraph","parent":"これで指定したテーブルの中のカラムを取得できます。","children":[]},{"blockId":"1ada501e-f337-8166-8123-d4645e5274dd","type":"paragraph","parent":"テーブル内のすべてのデータを取得したい場合はカラム名に`*`を指定します。","children":[]},{"blockId":"1ada501e-f337-818e-af56-f22774983f0e","type":"callout","parent":"{\"icon\":{\"type\":\"external\",\"external\":{\"url\":\"https://www.notion.so/icons/code_gray.svg\"}},\"color\":\"default_background\",\"parent\":\"> テーブル内のすべてのデータを取得する  \\n> ```sql  \\n> SELECT * FROM テーブル名  \\n> ```\"}","children":[{"blockId":"1ada501e-f337-81fb-bded-f2a0807eb5a1","type":"code","parent":"```sql\nSELECT * FROM テーブル名\n```","children":[]}]},{"blockId":"1ada501e-f337-81df-88a3-d52135769fca","type":"paragraph","parent":"取得するデータの条件を指定するには、`WHERE` 句をつけます。","children":[]},{"blockId":"1ada501e-f337-81af-b640-e6a8fceb1b6e","type":"callout","parent":"{\"icon\":{\"type\":\"external\",\"external\":{\"url\":\"https://www.notion.so/icons/code_gray.svg\"}},\"color\":\"default_background\",\"parent\":\"> 取り出すデータに条件を指定する  \\n> ```sql  \\n> SELECT カラム名 FROM テーブル名 WHERE 条件  \\n> ```\"}","children":[{"blockId":"1ada501e-f337-8166-a257-e772d4d1c65b","type":"code","parent":"```sql\nSELECT カラム名 FROM テーブル名 WHERE 条件\n```","children":[]}]},{"blockId":"1ada501e-f337-8104-88bc-f53f263a3f39","type":"paragraph","parent":"条件をつけることでどの行のデータを取得するかを指定できます。","children":[]},{"blockId":"1ada501e-f337-8179-89f2-f983d9bbf3a7","type":"paragraph","parent":"条件には、「idが何か」を指定することが多いです。","children":[]},{"blockId":"1ada501e-f337-81d8-bbb8-f36c55819d78","type":"paragraph","parent":"例えば、`id`の値が`1`の行のデータを取り出したい場合は以下のように書きます。","children":[]},{"blockId":"1ada501e-f337-812b-87cb-f58f8dc62b88","type":"callout","parent":"{\"icon\":{\"type\":\"external\",\"external\":{\"url\":\"https://www.notion.so/icons/code_gray.svg\"}},\"color\":\"default_background\",\"parent\":\"> id=1のデータのみを取得する  \\n> ```sql  \\n> SELECT * FROM テーブル名 WHERE id = 1  \\n> ```\"}","children":[{"blockId":"1ada501e-f337-817d-9ff2-c4ae8efdcfdb","type":"code","parent":"```sql\nSELECT * FROM テーブル名 WHERE id = 1\n```","children":[]}]},{"blockId":"1ada501e-f337-81e0-9086-f8b6d8807b7e","type":"paragraph","parent":"条件を複数指定する時は、`AND` を使います。","children":[]},{"blockId":"1ada501e-f337-81d2-9e76-d3b2cd9ac048","type":"callout","parent":"{\"icon\":{\"type\":\"external\",\"external\":{\"url\":\"https://www.notion.so/icons/code_gray.svg\"}},\"color\":\"default_background\",\"parent\":\"> 複数の条件を指定する  \\n> ```sql  \\n> SELECT カラム名 FROM テーブル名 WHERE 条件1 AND 条件2 AND ...  \\n> ```\"}","children":[{"blockId":"1ada501e-f337-81f4-ac2a-e8d633742d55","type":"code","parent":"```sql\nSELECT カラム名 FROM テーブル名 WHERE 条件1 AND 条件2 AND ...\n```","children":[]}]},{"blockId":"1ada501e-f337-8195-a068-c723c78094bb","type":"heading_2","parent":"## 実際にデータを取得してみよう","children":[]},{"blockId":"1ada501e-f337-81b7-83a2-fbdf69734b0a","type":"divider","parent":"---","children":[]},{"blockId":"1ada501e-f337-8176-a9be-f4147894f42e","type":"paragraph","parent":"「[**データの保存(Create)**](/posts/curriculums/1ada501e-f337-81e8-b251-df0f38a0cb23/1ada501e-f337-8124-834c-d232ae4e3855)」で保存したデータを取得してみよう。","children":[]},{"blockId":"1ada501e-f337-816f-8ea6-d3a20f965d07","type":"paragraph","parent":"新たにread.pyを作成してください。","children":[]},{"blockId":"1ada501e-f337-81ed-9a4e-fcace43acf58","type":"paragraph","parent":"read.pyの内容を以下のようにしてください。","children":[]},{"blockId":"1ada501e-f337-81f9-8697-df3c0d7af5fe","type":"callout","parent":"{\"icon\":{\"type\":\"external\",\"external\":{\"url\":\"https://www.notion.so/icons/code_gray.svg\"}},\"color\":\"default_background\",\"parent\":\"> read.py  \\n> ```python  \\n> import sqlite3  \\n>   \\n> dbname = 'TEST.db'  \\n> conn = sqlite3.connect(dbname)  \\n> cur = conn.cursor()  \\n>   \\n> **# personテーブルデータを全件取得  \\n> cur.execute('SELECT * FROM person')  \\n> data = cur.fetchall()  \\n> print(data)**  \\n>   \\n> conn.commit()  \\n>   \\n> cur.close()  \\n> conn.close()  \\n> ```\"}","children":[{"blockId":"1ada501e-f337-81e9-98df-c84ca17cf464","type":"code","parent":"```python\nimport sqlite3\n\ndbname = 'TEST.db'\nconn = sqlite3.connect(dbname)\ncur = conn.cursor()\n\n**# personテーブルデータを全件取得\ncur.execute('SELECT * FROM person')\ndata = cur.fetchall()\nprint(data)**\n\nconn.commit()\n\ncur.close()\nconn.close()\n```","children":[]}]},{"blockId":"1ada501e-f337-813d-a0bb-e4d1f287e982","type":"paragraph","parent":"このコードを実行してください。\n以下のように出力されればデータの取得に成功です。","children":[]},{"blockId":"1ada501e-f337-81d6-abcb-da94a5bb719d","type":"code","parent":"```bash\n[(1, 'Sato', 15, 'Man')]\n```","children":[]},{"blockId":"1ada501e-f337-8167-8563-f07d09ab3bb9","type":"paragraph","parent":"コードを見ていきましょう。","children":[]},{"blockId":"1ada501e-f337-8121-a614-c738379791c7","type":"paragraph","parent":"まず、`cur.execute(’SELECT * FROM person’)` で、`person`テーブルのデータをすべて取得するSQL文を実行します。次に、`fetchall`メソッドで取得したデータを全て変数`data`に代入し、`print`で出力しています。","children":[]},{"blockId":"1ada501e-f337-8133-8f5b-ec6ee1b05359","type":"heading_2","parent":"## 任意のデータを扱う","children":[]},{"blockId":"1ada501e-f337-8155-9b5b-d0ff4d2eb3b7","type":"divider","parent":"---","children":[]},{"blockId":"1ada501e-f337-8120-ac72-c793ffe80709","type":"paragraph","parent":"データの取得をより実用的に扱うには、データを取得するとき、任意の値で条件を指定する必要があります。","children":[]},{"blockId":"1ada501e-f337-8164-a2d5-f2414e9261e7","type":"paragraph","parent":"任意の値で条件を指定する方法を見ていきましょう。","children":[]},{"blockId":"1ada501e-f337-8153-946d-ef8436d7753a","type":"callout","parent":"{\"icon\":{\"type\":\"external\",\"external\":{\"url\":\"https://www.notion.so/icons/code_gray.svg\"}},\"color\":\"default_background\",\"parent\":\"> 例：idが任意の値の条件を指定する  \\n> ```python  \\n> cur.execute('SELECT カラム名 FROM テーブル名 WHERE id = ?',(指定したいidの値))  \\n> ```  \\n>   \\n> 🛑 `cur` = `cursor`オブジェクト\"}","children":[{"blockId":"1ada501e-f337-8183-bc9e-c79265373775","type":"code","parent":"```python\ncur.execute('SELECT カラム名 FROM テーブル名 WHERE id = ?',(指定したいidの値))\n```","children":[]},{"blockId":"1ada501e-f337-81b5-b69c-e7a7feb30fb9","type":"paragraph","parent":"🛑 `cur` = `cursor`オブジェクト","children":[]}]},{"blockId":"1ada501e-f337-81bc-90df-f24dfbac22ef","type":"paragraph","parent":"例えば、personテーブルから、任意のidの行のデータを取得するコードは以下のようになります。","children":[]},{"blockId":"1ada501e-f337-81aa-bc70-f97d2f347bd8","type":"callout","parent":"{\"icon\":{\"type\":\"external\",\"external\":{\"url\":\"https://www.notion.so/icons/code_gray.svg\"}},\"color\":\"default_background\",\"parent\":\"> personテーブルから、任意のidの行のデータを取得する  \\n> ```python  \\n> import sqlite3  \\n>   \\n> dbname = 'TEST.db'  \\n> conn = sqlite3.connect(dbname)  \\n> cur = conn.cursor()  \\n>   \\n> **# 任意の値を入れる  \\n> target_id = 1  \\n>   \\n> # personテーブルから任意の行のデータを取得  \\n> cur.execute('SELECT * FROM person WHERE id = ?',(target_id,))  \\n> data = cur.fetchall()**  \\n>   \\n> # 取得したデータを出力  \\n> print(data)  \\n>   \\n> conn.commit()  \\n>   \\n> cur.close()  \\n> conn.close()  \\n> ```\"}","children":[{"blockId":"1ada501e-f337-81f6-83ad-cf6d197c1dc8","type":"code","parent":"```python\nimport sqlite3\n\ndbname = 'TEST.db'\nconn = sqlite3.connect(dbname)\ncur = conn.cursor()\n\n**# 任意の値を入れる\ntarget_id = 1\n\n# personテーブルから任意の行のデータを取得\ncur.execute('SELECT * FROM person WHERE id = ?',(target_id,))\ndata = cur.fetchall()**\n\n# 取得したデータを出力\nprint(data)\n\nconn.commit()\n\ncur.close()\nconn.close()\n```","children":[]}]},{"blockId":"1ada501e-f337-81b5-ac4a-c24a5ace4fb3","type":"paragraph","parent":"このコードだと、`target_id`の値によって、テーブルから取得するデータの行が変わります。","children":[]},{"blockId":"1ada501e-f337-8197-8112-c6dc0e0e59aa","type":"paragraph","parent":"","children":[]},{"blockId":"1ada501e-f337-81eb-bd03-d9129a69361c","type":"paragraph","parent":"次→[**データの編集(Update)**](/posts/curriculums/1ada501e-f337-81e8-b251-df0f38a0cb23/1ada501e-f337-815a-a9e6-d8cdd63afa9c)","children":[]}],"pageNavs":[{"title":"Home","id":"/posts"},{"title":"基礎班カリキュラム","id":"/posts/course/basic"},{"title":"後期","id":"/posts/course/後期"},{"title":"データベース基礎","id":"/posts/curriculums/1ada501e-f337-81e8-b251-df0f38a0cb23/1ada501e-f337-81e8-b251-df0f38a0cb23"},{"id":"/posts/curriculums/1ada501e-f337-81e8-b251-df0f38a0cb23/1ada501e-f337-81fe-9043-da67e48709a8","title":"データの取得(Read)"}],"childrenData":{"title":"データベース基礎","childPages":[{"title":"データベースとは","id":"1ada501e-f337-81ce-889f-d99449a4ba30"},{"title":"Pythonでデータベースを扱うためのライブラリ","id":"1ada501e-f337-81ea-92d1-dcb4d8f60e2a"},{"title":"データベースとの接続とテーブルの作成","id":"1ada501e-f337-8160-b03e-f28f8a18fa43"},{"title":"データの保存(Create)","id":"1ada501e-f337-8124-834c-d232ae4e3855"},{"title":"データの取得(Read)","id":"1ada501e-f337-81fe-9043-da67e48709a8"},{"title":"データの編集(Update)","id":"1ada501e-f337-815a-a9e6-d8cdd63afa9c"},{"title":"データの削除(Delete)","id":"1ada501e-f337-8190-b5d5-ff083def3250"},{"title":"テーブルの編集","id":"1ada501e-f337-81a2-bb7a-d5bc48cd5f09"},{"title":"CRUD操作を使い回せるようにしよう","id":"1ada501e-f337-81d2-8f41-cd45c5a72b38"},{"title":"マイグレーション","id":"1ada501e-f337-81ac-a7f5-efdaf65ef9e7"},{"title":"カラムの属性","id":"1ada501e-f337-81bc-8a50-df2e526e6153"},{"title":"SQL文","id":"1ada501e-f337-8175-826a-d32ae9e3e34d"}]},"pageId":"1ada501e-f337-81fe-9043-da67e48709a8","pageInfo":{"id":11,"title":"## データの取得(Read)","iconType":"external","iconUrl":"https://www.notion.so/icons/move-document_blue.svg","pageId":"1ada501e-f337-81fe-9043-da67e48709a8","coverUrl":"","curriculumId":"1ada501e-f337-81e8-b251-df0f38a0cb23"},"childIcons":[]},"__N_SSG":true}