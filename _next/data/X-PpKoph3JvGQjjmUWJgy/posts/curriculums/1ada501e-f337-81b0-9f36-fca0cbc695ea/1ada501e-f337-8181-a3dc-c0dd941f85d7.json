{"pageProps":{"title":" 6. イベントハンドラと更新","metadata":{"title":"Flet","curriculumId":"1ada501e-f337-81b0-9f36-fca0cbc695ea","category":"前期","visibility":["基礎班","発展班"],"tags":["Flet","Python","基礎班","GUI"],"is_basic_curriculum":true,"id":"123","iconType":"file","iconUrl":"/horizon-atlas/notion_data/eachPage/1ada501e-f337-81b0-9f36-fca0cbc695ea/pageImageData/icon/1ada501e-f337-81b0-9f36-fca0cbc695ea.png","coverUrl":"https://images.unsplash.com/photo-1621508654686-809f23efdabc?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=4800"},"mdBlocks":[{"blockId":"1ada501e-f337-813c-a53b-d0eaea11cd4b","type":"paragraph","parent":"今回はGUIアプリを開発するうえで必要になる**イベントハンドラ**について紹介します。また、画面の**表示内容の更新**もこの章で紹介します。","children":[]},{"blockId":"1ada501e-f337-81f5-a430-eba28574b39a","type":"heading_1","parent":"# イベントハンドラ","children":[]},{"blockId":"1ada501e-f337-819e-ba47-daf3a5acd3e1","type":"divider","parent":"---","children":[]},{"blockId":"1ada501e-f337-81ca-8d07-c6ba1c898bb5","type":"paragraph","parent":"イベントハンドラとは、特定のイベントが発生したときに呼び出される処理のことです。","children":[]},{"blockId":"1ada501e-f337-81d4-96ce-d3c120e492df","type":"paragraph","parent":"…と聞くと難しそうかもしれませんが、**「ボタンが押されたらテキストを変える」**とか**「ボタンが押されたら別の画面を表示する」**とかそんな感じです。","children":[]},{"blockId":"1ada501e-f337-817d-a2e5-c3ad89ef7f47","type":"paragraph","parent":"イベントハンドラはいくつか種類がありますが、最も使用頻度の高いものが`on_click`でしょう。この`on_click`は主にボタンなどのコントロールで使用でき、コントロールがクリック/タップされたときに発動します。","children":[]},{"blockId":"1ada501e-f337-8124-ae3a-de86ddd13408","type":"paragraph","parent":"`on_click`はコントロールのプロパティとして設定します。そのコントロールがクリック/タップされたときに処理したい関数名を指定することで、イベントハンドラの設定が可能です。以下のコードを見てください。","children":[]},{"blockId":"1ada501e-f337-814b-a945-c2512f129b63","type":"code","parent":"```python\nimport flet as ft\n\ndef main(page: ft.Page):\n    def add_numbers(e):\n        result.value = int(num1.value) + int(num2.value)\n        result.update()\n\n    num1 = ft.TextField(label=\"数字1\")\n    num2 = ft.TextField(label=\"数字2\")\n    num_row = ft.Row(controls=[num1, num2])\n\n    add_button = ft.FilledButton(text=\"ADD\", on_click=add_numbers)\n    result = ft.Text()\n\n    page.add(num_row, add_button, result)\n\nft.app(target=main)\n```","children":[]},{"blockId":"1ada501e-f337-813a-9ecc-ddf0d488883a","type":"paragraph","parent":"これは、「数字1」テキストフィールドと「数字2」テキストフィールドに入力した数字同士を足し合わせて、ボタンが押されると結果を表示するアプリです。","children":[]},{"blockId":"1ada501e-f337-8119-b300-dfe5428d263e","type":"image","parent":"![%E8%B6%B3%E3%81%97%E7%AE%97_%E6%9C%AA%E5%85%A5%E5%8A%9B.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/4faae8b3-4c31-46a7-898b-465eb6114fd9/8bf5e96c-91f2-48aa-b3f5-6fb7a95a06ee/%E8%B6%B3%E3%81%97%E7%AE%97_%E6%9C%AA%E5%85%A5%E5%8A%9B.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662TVNOV3Z%2F20250318%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250318T031130Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEPr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIH547Baf%2Bns4WGoJnf%2BlTs%2B14rH3O5hU9XGQEPk4kvNwAiAn%2F%2BnI0j40n5mON%2Bwq7%2Fp%2Bhrc%2FB9iN%2BoSlZ1He8Qd0yCr%2FAwhTEAAaDDYzNzQyMzE4MzgwNSIM1GSOUn0rF9q7W7QlKtwDTb6qMGOX8kIOYceXp2J%2FdY8W8W10fbTDk0VJmvwvDBHgg72ibEznRuOr%2B5oxuIvCBh5EKJr%2FIs5dTXTgGpvMhoQTRKAUKDPBE48kq09Dymw99H5mbcrWhWYY4nElyel9ZpHQYjVvWBUAsHQY9JX%2B3PZIXW6Ut8CT933f%2FWZW6LJqgENRD03AI86KdwbIjwmg9ucizXIXfg7jDT8Qd2OP9RTCVoQ%2FnmVD0PIGo%2BfZniEtsD9YynF43hdz0WkngGfymRfAsHrdPvXkC4ipHwROOXenaUaXh%2BnfIyh2SuoUYjqgSPtTmpkcPoP0if21u4T7WhySReNWCHLh0ZwqF9uFdoQmWC0%2FTOdGjRbhiZNpA39ZxWI22FRXH4bFMbTRAmDMQ%2BE%2FhYkpq6kjgUEMWLAC8%2FligTfX%2FavMPgOa9hlNzNZe6PzzLpli%2BW37MNicfBwpTUZOV%2Bsp67E1%2FSNpZI3G7SQFDbSYpvJ8pEEAfJYi5N1wETLsvgxjCSwL4bcztcAOgF2IX%2B019448PXw%2FbBTuHAIxshkUiCNccC9ZCUtrVwE4FdGNJ3t1uj87R%2BS5mylhB0rz%2FS0cZBlgU7%2BcgIm0XfvcLcXnDG%2FemFur79OoL213WfGI2H00sAdoP74wqKrjvgY6pgH82tbdzA9N3Lc0ERH2F7dn63Ez26AalmcQOEv5BtjqV29%2FolDDVowbdcq0hHq3wXix02yyQqQOjKvF%2B2V%2BCPVkElLDCeSMtHISLrwQhnhk4goQMmCiR0pPBB8Y%2Fcpia81BrWYBoEjSM0xe5dQpt4NB40xOeGcbwYx95uPOmHxFGCGyoX%2BPoC3%2Bc8JyaJCGjsmsXNcpRFYfZl0Sw4R3whcROtltuOX7&X-Amz-Signature=73a043ec15d5d2dc22004774698c955539212752d34cb6cc87325deb18ccf3a9&X-Amz-SignedHeaders=host&x-id=GetObject)","children":[]},{"blockId":"1ada501e-f337-81a4-9694-e59fce8865bf","type":"paragraph","parent":"**数字を足し合わせ、結果を表示をする処理**が`add_number`関数として定義されており、「ADD」ボタンのプロパティに`on_click = add_number`を設定しています。これにより、このボタンを押したときに`add_number`関数が実行されます。","children":[]},{"blockId":"1ada501e-f337-8145-978c-d5d0ae8d1de9","type":"image","parent":"![%E8%B6%B3%E3%81%97%E7%AE%97_%E5%85%A5%E5%8A%9B%E6%B8%88%E3%81%BF.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/4faae8b3-4c31-46a7-898b-465eb6114fd9/4299ea45-71eb-45de-9c88-d57f853241d1/%E8%B6%B3%E3%81%97%E7%AE%97_%E5%85%A5%E5%8A%9B%E6%B8%88%E3%81%BF.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662TVNOV3Z%2F20250318%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250318T031130Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEPr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIH547Baf%2Bns4WGoJnf%2BlTs%2B14rH3O5hU9XGQEPk4kvNwAiAn%2F%2BnI0j40n5mON%2Bwq7%2Fp%2Bhrc%2FB9iN%2BoSlZ1He8Qd0yCr%2FAwhTEAAaDDYzNzQyMzE4MzgwNSIM1GSOUn0rF9q7W7QlKtwDTb6qMGOX8kIOYceXp2J%2FdY8W8W10fbTDk0VJmvwvDBHgg72ibEznRuOr%2B5oxuIvCBh5EKJr%2FIs5dTXTgGpvMhoQTRKAUKDPBE48kq09Dymw99H5mbcrWhWYY4nElyel9ZpHQYjVvWBUAsHQY9JX%2B3PZIXW6Ut8CT933f%2FWZW6LJqgENRD03AI86KdwbIjwmg9ucizXIXfg7jDT8Qd2OP9RTCVoQ%2FnmVD0PIGo%2BfZniEtsD9YynF43hdz0WkngGfymRfAsHrdPvXkC4ipHwROOXenaUaXh%2BnfIyh2SuoUYjqgSPtTmpkcPoP0if21u4T7WhySReNWCHLh0ZwqF9uFdoQmWC0%2FTOdGjRbhiZNpA39ZxWI22FRXH4bFMbTRAmDMQ%2BE%2FhYkpq6kjgUEMWLAC8%2FligTfX%2FavMPgOa9hlNzNZe6PzzLpli%2BW37MNicfBwpTUZOV%2Bsp67E1%2FSNpZI3G7SQFDbSYpvJ8pEEAfJYi5N1wETLsvgxjCSwL4bcztcAOgF2IX%2B019448PXw%2FbBTuHAIxshkUiCNccC9ZCUtrVwE4FdGNJ3t1uj87R%2BS5mylhB0rz%2FS0cZBlgU7%2BcgIm0XfvcLcXnDG%2FemFur79OoL213WfGI2H00sAdoP74wqKrjvgY6pgH82tbdzA9N3Lc0ERH2F7dn63Ez26AalmcQOEv5BtjqV29%2FolDDVowbdcq0hHq3wXix02yyQqQOjKvF%2B2V%2BCPVkElLDCeSMtHISLrwQhnhk4goQMmCiR0pPBB8Y%2Fcpia81BrWYBoEjSM0xe5dQpt4NB40xOeGcbwYx95uPOmHxFGCGyoX%2BPoC3%2Bc8JyaJCGjsmsXNcpRFYfZl0Sw4R3whcROtltuOX7&X-Amz-Signature=bff68b1f8c462dff9e516ce9ffa7886f1be3c2f6da1bcc42eb36f7df4e6189a0&X-Amz-SignedHeaders=host&x-id=GetObject)","children":[]},{"blockId":"1ada501e-f337-81a2-a858-f1dccffec4fa","type":"heading_1","parent":"# 表示内容の更新","children":[]},{"blockId":"1ada501e-f337-8181-881a-f9b70ac48677","type":"divider","parent":"---","children":[]},{"blockId":"1ada501e-f337-81f2-9b50-e370fd59d8eb","type":"paragraph","parent":"続いて、画面に表示する内容の更新について学びます。","children":[]},{"blockId":"1ada501e-f337-81c3-b0f6-d79370ae50e5","type":"paragraph","parent":"より詳細に言い換えると、**コントロールのプロパティの更新**ということになります。基本的にこのコントロールのプロパティの更新は","children":[]},{"blockId":"1ada501e-f337-81ae-a16e-da2b4a188338","type":"numbered_list_item","parent":"1. **プロパティに新しい値をセット**","children":[]},{"blockId":"1ada501e-f337-812a-8197-db03a012b271","type":"numbered_list_item","parent":"2. **`update`****メソッドで更新を反映**","children":[]},{"blockId":"1ada501e-f337-8196-b7c4-c2d7bdc96f23","type":"paragraph","parent":"の2ステップで実行します。","children":[]},{"blockId":"1ada501e-f337-81eb-ac6b-d8e3f4ae053b","type":"paragraph","parent":"すでに上記のコード例でもコントロールのプロパティの更新は実装されています。`add_number`関数の中身に注目しましょう。","children":[]},{"blockId":"1ada501e-f337-8187-88eb-e03bcc4daf3c","type":"code","parent":"```python\ndef add_numbers(e):\n        result.value = int(num1.value) + int(num2.value)\n        result.update()\n```","children":[]},{"blockId":"1ada501e-f337-81d6-83c1-f216e370b6f1","type":"paragraph","parent":"`add_number`関数では`result`コントロールの`value`プロパティに二つの数字を足した値を代入したあと、`result.update()`を実行し、`result`コントロールの更新を画面上に反映しています。","children":[]},{"blockId":"1ada501e-f337-816c-8ed5-e04e5b57ba02","type":"heading_1","parent":"# イベントオブジェクト","children":[]},{"blockId":"1ada501e-f337-818e-92d4-e34ac5a03c2c","type":"divider","parent":"---","children":[]},{"blockId":"1ada501e-f337-8120-b8c1-dd10c1392336","type":"paragraph","parent":"もうひとつ、イベントハンドラを使用する際に大切なものがあります。それが、**イベントオブジェクト**です。","children":[]},{"blockId":"1ada501e-f337-81dc-9786-dcdb083ddc95","type":"paragraph","parent":"このイベントオブジェクトは、イベントハンドラで関数が実行された際、その関数の引数として渡されるものです。","children":[]},{"blockId":"1ada501e-f337-813b-903a-d25f61fb4751","type":"paragraph","parent":"もう一度、先程の`add_number`関数を見てみましょう。","children":[]},{"blockId":"1ada501e-f337-8181-a216-c0b0e5084289","type":"code","parent":"```python\ndef add_numbers(**e**):\n        result.value = int(num1.value) + int(num2.value)\n        result.update()\n```","children":[]},{"blockId":"1ada501e-f337-81bb-9d25-f8f044e623f6","type":"paragraph","parent":"太字で強調されている**`e`**がイベントオブジェクトです。","children":[]},{"blockId":"1ada501e-f337-81d2-8a16-e2ebc2238849","type":"paragraph","parent":"イベントオブジェクトの名前は`e`以外でもなんでも大丈夫ですが、慣例として`e`や`event`が使用されることが多いです。","children":[]},{"blockId":"1ada501e-f337-8107-a18a-ccc0fc164d66","type":"paragraph","parent":"このイベントオブジェクトには、その関数（上記では`add_numbers`）を呼び出した**コントロール**のさまざまな情報が含まれます。","children":[]},{"blockId":"1ada501e-f337-812f-82bf-d8f59b8548ae","type":"paragraph","parent":"例えば、以下のような`ft.FilledButton`コントロールと、その`on_click`（**イベントハンドラ**）によって実行される、`button_pushed`関数があるとします。","children":[]},{"blockId":"1ada501e-f337-81e1-80da-c3c891aa2c3f","type":"code","parent":"```python\nbt = ft.FilledButton(text=\"テストボタン\", on_click=button_pushed)\n\ndef button_pushed(e):\n\tbutton_text = e.control.text\n\tprint(button_text, \"が押されました\")\n```","children":[]},{"blockId":"1ada501e-f337-813f-8987-f5ad094f7cae","type":"paragraph","parent":"`button_pushed`関数に引数として与えられたイベントハンドラ`e`の`.control.text`を参照することで、この関数を実行した`bt`の`text`プロパティを見ることができます。","children":[]},{"blockId":"1ada501e-f337-81a8-b96e-e4f271d96df1","type":"paragraph","parent":"以下に実際に**イベントオブジェクト**を使用したデモを示します。","children":[]},{"blockId":"1ada501e-f337-8151-a3c1-d4dfc190361a","type":"paragraph","parent":"ボタンが押されると、関数がイベントオブジェクトからそのボタンの`text`プロパティを読み込み、ボタンの下にある文章の内容を変更します。","children":[]},{"blockId":"1ada501e-f337-8115-8822-d9173e0fe8ce","type":"embed","parent":"[embed](https://flet-samples.fly.dev/event_object)","children":[]},{"blockId":"1ada501e-f337-8140-a582-c84730d0b0c1","type":"toggle","parent":"上記デモのコード","children":[{"blockId":"1ada501e-f337-81e7-9ce9-e9c4e143ee2d","type":"code","parent":"```python\nimport flet as ft\n\ndef main(page: ft.Page):\n    # page.horizontal_alignment=ft.CrossAxisAlignment.CENTER\n\n    # テキストコントロールを作成\n    text_control = ft.Text(value=\"\", size=35)\n\n    # ボタンが押された時のイベントハンドラ\n    def button_clicked(e):\n        button_name = e.control.text\n        text_control.value = button_name + \"が押されました\"\n        text_control.update()\n\n    # ボタンを作成\n    button1 = ft.FilledButton(text=\"ボタン1\", on_click=button_clicked)\n    button2 = ft.FilledButton(text=\"ボタンB\", on_click=button_clicked)\n    button3 = ft.FilledButton(text=\"ボタンⅢ\", on_click=button_clicked)\n\n    # ボタンを横並びに配置\n    button_row = ft.Row(\n        controls=[button1, button2, button3],\n        alignment=ft.MainAxisAlignment.CENTER\n    )\n\n    main_container = ft.Container(\n        content=ft.Column(\n            controls=[\n                button_row,\n                text_control,\n            ],\n            horizontal_alignment=ft.CrossAxisAlignment.CENTER\n        ),\n        height=250,\n        padding=20,\n        border=ft.border.all(2, ft.colors.BLACK),\n    )\n\n    # ページに要素を追加\n    page.add(main_container)\n\n# Fletアプリを実行\nft.app(target=main)\n```","children":[]}]}],"pageNavs":[{"title":"Home","id":"/posts"},{"title":"基礎班カリキュラム","id":"/posts/course/basic"},{"title":"前期","id":"/posts/course/前期"},{"title":"Flet","id":"/posts/curriculums/1ada501e-f337-81b0-9f36-fca0cbc695ea/1ada501e-f337-81b0-9f36-fca0cbc695ea"},{"id":"/posts/curriculums/1ada501e-f337-81b0-9f36-fca0cbc695ea/1ada501e-f337-8181-a3dc-c0dd941f85d7","title":" 6. イベントハンドラと更新"}],"childrenData":{"title":"Flet","childPages":[{"title":" 0. GUIとFletについて","id":"1ada501e-f337-813a-8c94-db33d2a2aba8"},{"title":" 1. Fletのインストール","id":"1ada501e-f337-8127-a1ab-e7c4e69a6f4a"},{"title":" 2. カウンターを作ってみよう","id":"1ada501e-f337-8189-8b63-dbb7026b58e2"},{"title":" 3. ページの生成","id":"1ada501e-f337-8166-a1f8-cb646efc1eaa"},{"title":" 4. コントロール","id":"1ada501e-f337-8121-b442-c84b9cf10207"},{"title":" Fletの練習問題1","id":"1ada501e-f337-813a-b584-f840db3d66a6"},{"title":" 5. コントロールのレイアウト","id":"1ada501e-f337-8114-b302-f7ac74303640"},{"title":" Fletの練習問題2","id":"1ada501e-f337-8109-b409-f864f8aa0754"},{"title":" 6. イベントハンドラと更新","id":"1ada501e-f337-8181-a3dc-c0dd941f85d7"},{"title":" Fletの練習問題3","id":"1ada501e-f337-817c-8161-e5789a7e37f4"},{"title":" 電卓について","id":"1ada501e-f337-810c-8b91-efc304f3969f"}]},"pageId":"1ada501e-f337-8181-a3dc-c0dd941f85d7","iconInfo":[],"iconUrl":"https://www.notion.so/icons/refresh_green.svg","iconType":"external","coverUrl":""},"__N_SSG":true}